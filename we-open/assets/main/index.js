window.__require=function e(t,i,n){function o(r,c){if(!i[r]){if(!t[r]){var s=r.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var p=i[r]={exports:{}};t[r][0].call(p.exports,function(e){return o(t[r][1][e]||e)},p,p.exports,e,t,i,n)}return i[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<n.length;r++)o(n[r]);return o}({use_reversed_rotateBy:[function(e,t,i){"use strict";cc._RF.push(t,"bac1eAX8cpHKZJE6AdkfFZe","use_reversed_rotateBy"),cc.RotateBy._reverse=!0,cc._RF.pop()},{}],weixin:[function(e,t,i){"use strict";cc._RF.push(t,"37281/bRn5AqLb3huSIHZ5w","weixin"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,o=n.ccclass,a=n.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.haoyou=null,t.pai=null,t.item_hao=null,t.item_pai=null,t.server=null,t.list_hao=null,t.list_pai=[],t}return __extends(t,e),t.prototype.start=function(){var e=this;this.server=wx.getGameServerManager(),this.server.onStateUpdate(this.onStateUpdate),wx.onMessage(function(t){"userlist"===t?e.getUserList(0):"showuserlist"===t?e.getUserList(1):"showpai"===t&&e.getPai("renwu")})},t.prototype.onStateUpdate=function(e){},t.prototype.getUserList=function(e){var t=this;this.server.getFriendsStateData({success:function(i){t.list_hao=i.list,console.log("\u83b7\u53d6\u597d\u53cb\u5217\u8868",t.list_hao),1==e&&t.showHao()},fail:function(e){console.error("\u83b7\u53d6\u597d\u53cb\u5217\u8868\u5931\u8d25")}})},t.prototype.showHao=function(){if(this.item_hao.parent.childrenCount>1)for(var e=0;e<this.item_hao.parent.children.length;e++){var t=this.item_hao.parent.children[e];e>0&&t.destroy()}for(e=0;e<this.list_hao.length;e++){var i=this.list_hao[e],n=null,o=null,a=null,r=null,c=null,s=null,l=null,p=null,h=null;if(e>0){var g=cc.instantiate(this.item_hao);g.parent=this.item_hao.parent,this.item_pai.parent.getComponent(cc.Layout).updateLayout(),n=g.getChildByName("zeng").getComponent(cc.Button),o=g.getChildByName("yao").getComponent(cc.Button),r=(a=g.getChildByName("haoyou")).getChildByName("user"),c=a.getChildByName("icon").getComponent(cc.Sprite),s=a.getChildByName("icon_bi").getChildByName("bi").getComponent(cc.Label),l=r.getChildByName("nickname").getComponent(cc.Label),p=r.getChildByName("state_user").getComponent(cc.Label),h=r.getChildByName("state_game").getComponent(cc.Label)}else n=this.item_hao.getChildByName("zeng").getComponent(cc.Button),o=this.item_hao.getChildByName("yao").getComponent(cc.Button),r=(a=this.item_hao.getChildByName("haoyou")).getChildByName("user"),c=a.getChildByName("icon").getComponent(cc.Sprite),s=a.getChildByName("icon_bi").getChildByName("bi").getComponent(cc.Label),l=r.getChildByName("nickname").getComponent(cc.Label),p=r.getChildByName("state_user").getComponent(cc.Label),h=r.getChildByName("state_game").getComponent(cc.Label);if(this.createImage(c,i.avatarUrl),i.userState){var m=JSON.parse(i.userState);s.string=m.bi,0==m.state?h.string="\u6e38\u620f\u72b6\u6001:\u51c6\u5907\u4e2d":1==m.state&&(h.string="\u6e38\u620f\u72b6\u6001:\u6e38\u620f\u4e2d")}else s.string="-",h.string="\u6e38\u620f\u72b6\u6001:\u6e38\u620f\u4e2d";l.string=i.nickName,0==i.sysState?p.string="\u5728\u7ebf\u72b6\u6001:\u6389\u7ebf":p.string="\u5728\u7ebf\u72b6\u6001:\u5728\u7ebf";var u=new cc.Component.EventHandler;u.customEventData=e+"",u.target=this.node,u.component="weixin",u.handler="zengClick",console.log(n),n.clickEvents[0]=u;var d=new cc.Component.EventHandler;d.customEventData=e+"",d.component="weixin",d.target=this.node,d.handler="yaoClick",o.clickEvents[0]=d}this.haoyou.active=!0,this.pai.active=!1},t.prototype.createImage=function(e,t){cc.loader.release(t),cc.loader.load({url:t,type:"png"},function(t,i){if(t)console.log(t);else{var n=new cc.SpriteFrame(i);e.spriteFrame=n,console.log("\u5934\u50cf\u52a0\u8f7d\u6210\u529f")}})},t.prototype.zengClick=function(e,t){console.log("asfdsgdfgfg"),wx.modifyFriendInteractiveStorage({key:"1",opNum:1,operation:"add",toUser:this.list_hao[parseInt(t)].openid,title:"\u9001\u4f60 100 \u4e2a\u91d1\u5e01\uff0c\u8d76\u5feb\u6253\u5f00\u6e38\u620f\u770b\u770b\u5427",imageUrl:"https://mmocgame.qpic.cn/wechatgame/fz45DryicnHmPNEgSqxfsNXXznCeBrJRJbkibwDicy1bfNHOSqe0AknwZu1ZJjXNLMib/0",imageUrlId:"4i6qRdmESOapDquTWTAhCw=="})},t.prototype.yaoClick=function(e,t){console.log("asfdsgdfgfadsadsadasg"),this.server.inviteFriend({openId:this.list_hao[parseInt(t)].openid,success:function(){wx.showToast({title:"\u9080\u8bf7\u6210\u529f",icon:"success",duration:800})}})},t.prototype.getPai=function(e){var t=this;wx.getFriendCloudStorage({keyList:[e],success:function(i){var n,o,a,r;if(console.log(i),t.list_pai=[],i.data){for(var c=0;c<i.data.length;c++)(o=i.data[c]).KVDataList.length&&((n={}).img_head=o.avatarUrl,n.text_name=o.nickname,n.openid=o.openid,n.index_t=c+1,a=o.KVDataList[0],r=JSON.parse(a.value).wxgame,n.text_score="time"==e?r.time:r.renwu,n.update_time=r.update_time,t.list_pai.push(n));t.list_pai=t.list_pai.sort(function(e,t){return t.text_score-e.text_score});for(c=0;c<t.list_pai.length;c++)t.list_pai[c].index=c+1;t.showPai()}},fail:function(e){console.log("------------------\u83b7\u53d6\u6258\u7ba1\u6570\u636e\u5931\u8d25--------------------"),console.log(e)}})},t.prototype.showPai=function(){if(this.item_pai.parent.childrenCount>1)for(var e=0;e<this.item_pai.parent.children.length;e++){var t=this.item_pai.parent.children[e];e>0&&t.destroy()}for(e=0;e<this.list_pai.length;e++){var i=this.list_pai[e],n=null,o=null,a=null,r=null,c=null,s=null,l=null,p=null;if(e>0){var h=cc.instantiate(this.item_pai);h.parent=this.item_pai.parent,this.item_pai.parent.getComponent(cc.Layout).updateLayout(),n=h.getChildByName("zeng").getComponent(cc.Button),o=h.getChildByName("yao").getComponent(cc.Button),r=(a=h.getChildByName("haoyou")).getChildByName("index").getComponent(cc.Label),c=a.getChildByName("user"),s=a.getChildByName("icon").getComponent(cc.Sprite),l=a.getChildByName("icon_bi").getChildByName("bi").getComponent(cc.Label),p=c.getChildByName("nickname").getComponent(cc.Label)}else n=this.item_pai.getChildByName("zeng").getComponent(cc.Button),o=this.item_pai.getChildByName("yao").getComponent(cc.Button),r=(a=this.item_pai.getChildByName("haoyou")).getChildByName("index").getComponent(cc.Label),c=a.getChildByName("user"),s=a.getChildByName("icon").getComponent(cc.Sprite),l=a.getChildByName("icon_bi").getChildByName("bi").getComponent(cc.Label),p=c.getChildByName("nickname").getComponent(cc.Label);this.createImage(s,i.img_head),l.string=i.text_score,r.string="No."+(e+1),p.string=i.text_name;var g=new cc.Component.EventHandler;g.customEventData=e+"",g.target=this.node,g.component="weixin",g.handler="zengClick1",n.clickEvents[0]=g;var m=new cc.Component.EventHandler;m.customEventData=e+"",m.target=this.node,m.component="weixin",m.handler="yaoClick1",o.clickEvents[0]=m}this.pai.active=!0,this.haoyou.active=!1},t.prototype.zengClick1=function(e,t){wx.modifyFriendInteractiveStorage({key:"1",opNum:1,operation:"add",toUser:this.list_pai[parseInt(t)].openid,title:"\u9001\u4f60 100 \u4e2a\u91d1\u5e01\uff0c\u8d76\u5feb\u6253\u5f00\u6e38\u620f\u770b\u770b\u5427",imageUrl:"https://mmocgame.qpic.cn/wechatgame/fz45DryicnHmPNEgSqxfsNXXznCeBrJRJbkibwDicy1bfNHOSqe0AknwZu1ZJjXNLMib/0",imageUrlId:"4i6qRdmESOapDquTWTAhCw=="})},t.prototype.yaoClick1=function(e,t){this.server.inviteFriend({openId:this.list_pai[parseInt(t)].openid,success:function(){wx.showToast({title:"\u9080\u8bf7\u6210\u529f",icon:"success",duration:800})}})},t.prototype.onDestroy=function(){this.server.offStateUpdate(this.onStateUpdate)},__decorate([a(cc.Node)],t.prototype,"haoyou",void 0),__decorate([a(cc.Node)],t.prototype,"pai",void 0),__decorate([a(cc.Node)],t.prototype,"item_hao",void 0),__decorate([a(cc.Node)],t.prototype,"item_pai",void 0),t=__decorate([o],t)}(cc.Component);i.default=r,cc._RF.pop()},{}]},{},["use_reversed_rotateBy","weixin"]);